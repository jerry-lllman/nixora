# @nixora/ui Web åº”ç”¨ â†’ ç»„ä»¶åº“æ”¹é€ è®¡åˆ’

## é¡¹ç›®è¯Šæ–­

å½“å‰çŠ¶æ€ï¼šæ ‡å‡† Vite + React + TypeScript Web åº”ç”¨
ç›®æ ‡çŠ¶æ€ï¼šå¯è¢«å…¶ä»–é¡¹ç›®å¼•ç”¨çš„ React ç»„ä»¶åº“

---

## æ”¹é€ æ­¥éª¤ï¼ˆå…± 7 æ­¥ï¼Œæ¯æ­¥ç‹¬ç«‹å¯éªŒè¯ï¼‰

### ç¬¬ 1 æ­¥ï¼šé…ç½® Vite Library Mode

**ç›®æ ‡**ï¼šå°† Vite æ„å»ºæ¨¡å¼ä» SPA æ”¹ä¸º Library

**æ“ä½œ**ï¼š
1. ä¿®æ”¹ `vite.config.ts`
   - æ·»åŠ  `build.lib` é…ç½®
   - é…ç½®å…¥å£æ–‡ä»¶ä¸º `src/index.ts`
   - é…ç½®åº“åç§°ä¸º `NixoraUI`
   - é…ç½®è¾“å‡ºæ ¼å¼ï¼šES å’Œ UMD

2. æ·»åŠ  `build.rollupOptions.external`
   - å°† `react` å’Œ `react-dom` æ ‡è®°ä¸ºå¤–éƒ¨ä¾èµ–

**éªŒè¯**ï¼š
- é…ç½®æ–‡ä»¶æ— è¯­æ³•é”™è¯¯
- è¿è¡Œ `pnpm build` ä¸æŠ¥é…ç½®é”™è¯¯ï¼ˆå³ä½¿æ„å»ºå¤±è´¥ä¹Ÿæ²¡å…³ç³»ï¼‰

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `vite.config.ts`

**é¢„æœŸè¾“å‡º**ï¼š
```
dist/
  nixora-ui.es.js
  nixora-ui.umd.js
```

---

### ç¬¬ 2 æ­¥ï¼šé…ç½® TypeScript ç±»å‹å£°æ˜ç”Ÿæˆ

**ç›®æ ‡**ï¼šç”Ÿæˆ `.d.ts` ç±»å‹å£°æ˜æ–‡ä»¶ä¾›æ¶ˆè´¹è€…ä½¿ç”¨

**æ“ä½œ**ï¼š
1. ä¿®æ”¹ `tsconfig.app.json`
   - è®¾ç½® `declaration: true`
   - è®¾ç½® `declarationDir: "./dist/types"`
   - è®¾ç½® `emitDeclarationOnly: true`
   - ç§»é™¤ `noEmit: true`ï¼ˆä¸ declaration å†²çªï¼‰

2. å®‰è£…ç±»å‹ç”Ÿæˆæ’ä»¶
   ```bash
   pnpm add -D vite-plugin-dts
   ```

3. åœ¨ `vite.config.ts` ä¸­é›†æˆ `vite-plugin-dts`

**éªŒè¯**ï¼š
- TypeScript ç¼–è¯‘æ— é”™è¯¯
- è¿è¡Œ `pnpm build` ç”Ÿæˆ `dist/types/**/*.d.ts` æ–‡ä»¶

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `tsconfig.app.json`
- `vite.config.ts`
- `package.json` (devDependencies)

**é¢„æœŸè¾“å‡º**ï¼š
```
dist/
  types/
    index.d.ts
    components/**/*.d.ts
```

---

### ç¬¬ 3 æ­¥ï¼šé…ç½® package.json å¯¼å‡ºå­—æ®µ

**ç›®æ ‡**ï¼šæ­£ç¡®é…ç½® npm åŒ…çš„å…¥å£å’Œç±»å‹å£°æ˜

**æ“ä½œ**ï¼š
1. ä¿®æ”¹ `package.json`
   - ç§»é™¤ `private: true`
   - æ·»åŠ  `main` å­—æ®µï¼š`"./dist/nixora-ui.umd.js"`
   - æ·»åŠ  `module` å­—æ®µï¼š`"./dist/nixora-ui.es.js"`
   - æ·»åŠ  `types` å­—æ®µï¼š`"./dist/types/index.d.ts"`
   - æ·»åŠ  `exports` å­—æ®µï¼ˆæ”¯æŒ modern importsï¼‰
   - æ·»åŠ  `files` å­—æ®µï¼š`["dist"]`
   - ä¿®æ”¹ `scripts.build`ï¼š`"tsc && vite build"`

2. ç§»é™¤ Web åº”ç”¨ç‰¹æœ‰çš„ scripts
   - åˆ é™¤ `scripts.dev`
   - åˆ é™¤ `scripts.preview`

**éªŒè¯**ï¼š
- `package.json` æ ¼å¼æ­£ç¡®
- è¿è¡Œ `pnpm build` æˆåŠŸ

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `package.json`

**å‚è€ƒé…ç½®**ï¼š
```json
{
  "main": "./dist/nixora-ui.umd.js",
  "module": "./dist/nixora-ui.es.js",
  "types": "./dist/types/index.d.ts",
  "exports": {
    ".": {
      "types": "./dist/types/index.d.ts",
      "import": "./dist/nixora-ui.es.js",
      "require": "./dist/nixora-ui.umd.js"
    },
    "./styles.css": "./dist/style.css"
  },
  "files": ["dist"]
}
```

---

### ç¬¬ 4 æ­¥ï¼šè°ƒæ•´ä¾èµ–ç±»å‹ï¼ˆdependencies â†’ peerDependenciesï¼‰

**ç›®æ ‡**ï¼šé¿å…é‡å¤æ‰“åŒ… Reactï¼Œè®©æ¶ˆè´¹è€…æä¾› React è¿è¡Œæ—¶

**æ“ä½œ**ï¼š
1. ä¿®æ”¹ `package.json`
   - å°† `react` å’Œ `react-dom` ä» `dependencies` ç§»åŠ¨åˆ° `peerDependencies`
   - ä¿ç•™ `tailwindcss` ç›¸å…³ä¾èµ–åœ¨ `dependencies`ï¼ˆå› ä¸ºæ ·å¼éœ€è¦æ‰“åŒ…ï¼‰
   - ä¿ç•™å·¥å…·åº“ï¼ˆ`clsx`, `class-variance-authority`, `tailwind-merge`ï¼‰åœ¨ `dependencies`

**éªŒè¯**ï¼š
- è¿è¡Œ `pnpm install` æ— é”™è¯¯
- æ£€æŸ¥ `node_modules` ä¸­ React ä»ç„¶å­˜åœ¨ï¼ˆå› ä¸ºå¼€å‘éœ€è¦ï¼‰

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `package.json`

**å‚è€ƒé…ç½®**ï¼š
```json
{
  "peerDependencies": {
    "react": "^18.0.0 || ^19.0.0",
    "react-dom": "^18.0.0 || ^19.0.0"
  },
  "dependencies": {
    "@tailwindcss/vite": "^4.1.14",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.0",
    "lucide-react": "^0.546.0",
    "tailwind-merge": "^3.3.1",
    "tailwindcss": "^4.1.14"
  }
}
```

---

### ç¬¬ 5 æ­¥ï¼šåˆ›å»ºç»„ä»¶åº“å…¥å£æ–‡ä»¶

**ç›®æ ‡**ï¼šæä¾›ç»Ÿä¸€çš„å¯¼å‡ºå…¥å£

**æ“ä½œ**ï¼š
1. åˆ›å»º `src/index.ts` æ–‡ä»¶
   - å¯¼å‡ºå·¥å…·å‡½æ•°ï¼š`export * from './lib/utils'`
   - é¢„ç•™ç»„ä»¶å¯¼å‡ºä½ç½®ï¼ˆç›®å‰ä¸ºç©ºï¼‰

2. æ·»åŠ æ³¨é‡Šè¯´æ˜ç»„ä»¶å¯¼å‡ºè§„èŒƒ
   ```typescript
   // æœªæ¥æ·»åŠ ç»„ä»¶åçš„å¯¼å‡ºæ–¹å¼ï¼š
   // export { Button } from './components/button'
   ```

**éªŒè¯**ï¼š
- TypeScript æ— ç¼–è¯‘é”™è¯¯
- è¿è¡Œ `pnpm build` ç”Ÿæˆ `dist/index.d.ts`

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `src/index.ts` (æ–°å»º)

**å‚è€ƒå†…å®¹**ï¼š
```typescript
// å¯¼å‡ºå·¥å…·å‡½æ•°
export * from './lib/utils'

// æœªæ¥ç»„ä»¶å¯¼å‡ºç¤ºä¾‹ï¼ˆå½“å‰æ— ç»„ä»¶ï¼‰
// export { Button } from './components/button'
// export { Input } from './components/input'
```

---

### ç¬¬ 6 æ­¥ï¼šæ¸…ç† Web åº”ç”¨ç›¸å…³æ–‡ä»¶

**ç›®æ ‡**ï¼šç§»é™¤ä¸å†éœ€è¦çš„ Web åº”ç”¨å…¥å£å’Œèµ„æº

**æ“ä½œ**ï¼š
1. åˆ é™¤æ–‡ä»¶
   - `src/main.tsx`
   - `src/App.tsx`
   - `src/App.css`
   - `index.html`
   - `public/vite.svg`
   - `src/assets/react.svg`

2. ä¿ç•™æ–‡ä»¶
   - `src/index.css` (ä¿ç•™ä½œä¸ºç»„ä»¶æ ·å¼åŸºç¡€)
   - `src/lib/utils.ts` (å·¥å…·å‡½æ•°)

**éªŒè¯**ï¼š
- è¿è¡Œ `pnpm build` æˆåŠŸ
- æ£€æŸ¥ `dist` ç›®å½•åŒ…å«é¢„æœŸæ–‡ä»¶

**æ¶‰åŠæ–‡ä»¶**ï¼š
- å¤šä¸ªå¾…åˆ é™¤æ–‡ä»¶ï¼ˆè§ä¸Šï¼‰

**æ³¨æ„**ï¼š
- è¿™ä¸€æ­¥ä¸å½±å“æ„å»ºï¼Œå¯ä»¥æœ€ååš
- å¦‚æœä¸ç¡®å®šï¼Œå¯ä»¥å…ˆé‡å‘½åä¸º `.bak` è€Œä¸æ˜¯åˆ é™¤

---

### ç¬¬ 7 æ­¥ï¼šæ·»åŠ å¼€å‘ç¯å¢ƒæ”¯æŒï¼ˆå¯é€‰ï¼‰

**ç›®æ ‡**ï¼šæä¾›ç»„ä»¶é¢„è§ˆå’Œå¼€å‘è°ƒè¯•èƒ½åŠ›

**æ“ä½œ**ï¼š
1. åˆ›å»º `dev` ç›®å½•ç”¨äºæœ¬åœ°å¼€å‘
   ```
   dev/
     index.html
     main.tsx
     App.tsx
   ```

2. ä¿®æ”¹ `vite.config.ts`
   - æ·»åŠ  `root` é…ç½®åˆ¤æ–­ï¼šå¼€å‘æ¨¡å¼ä½¿ç”¨ `dev` ç›®å½•

3. æ¢å¤ `package.json` ä¸­çš„ `dev` è„šæœ¬
   ```json
   "scripts": {
     "dev": "vite dev",
     "build": "tsc && vite build"
   }
   ```

**éªŒè¯**ï¼š
- è¿è¡Œ `pnpm dev` å¯åŠ¨å¼€å‘æœåŠ¡å™¨
- å¯ä»¥åœ¨ `dev/App.tsx` ä¸­å¯¼å…¥å¹¶æµ‹è¯•ç»„ä»¶

**æ¶‰åŠæ–‡ä»¶**ï¼š
- `dev/**/*` (æ–°å»º)
- `vite.config.ts`
- `package.json`

**çŠ¶æ€**ï¼šå¯é€‰æ­¥éª¤ï¼Œå»ºè®®åœ¨æ­¥éª¤ 1-6 å®Œæˆåå†åš

---

## æ”¹é€ åçš„é¡¹ç›®ç»“æ„

```
packages/ui/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/        # æœªæ¥çš„ç»„ä»¶ç›®å½•
â”‚   â”‚   â””â”€â”€ button/
â”‚   â”‚       â”œâ”€â”€ button.tsx
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ utils.ts       # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ index.css          # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ index.ts           # ğŸ“Œ ç»„ä»¶åº“å…¥å£
â”œâ”€â”€ dev/                   # å¼€å‘é¢„è§ˆç›®å½•ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ main.tsx
â”‚   â””â”€â”€ App.tsx
â”œâ”€â”€ dist/                  # æ„å»ºè¾“å‡º
â”‚   â”œâ”€â”€ nixora-ui.es.js
â”‚   â”œâ”€â”€ nixora-ui.umd.js
â”‚   â”œâ”€â”€ style.css
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.d.ts
â”œâ”€â”€ vite.config.ts         # Library æ¨¡å¼é…ç½®
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tsconfig.app.json      # å¼€å¯ declaration
â””â”€â”€ package.json           # é…ç½® main/module/types/exports
```

---

## éªŒè¯æ”¹é€ ç»“æœ

### 1. æœ¬åœ°æ„å»ºéªŒè¯
```bash
pnpm build
```

**é¢„æœŸè¾“å‡º**ï¼š
- `dist/nixora-ui.es.js` (ESM æ ¼å¼)
- `dist/nixora-ui.umd.js` (UMD æ ¼å¼)
- `dist/style.css` (æ ·å¼æ–‡ä»¶)
- `dist/types/index.d.ts` (ç±»å‹å£°æ˜)

### 2. åœ¨å…¶ä»–é¡¹ç›®ä¸­æµ‹è¯•å¼•ç”¨

åœ¨ `apps/studio` æˆ–å…¶ä»–é¡¹ç›®ä¸­ï¼š

```typescript
import { cn } from '@nixora/ui'  // å¯¼å…¥å·¥å…·å‡½æ•°
import '@nixora/ui/styles.css'   // å¯¼å…¥æ ·å¼

// æœªæ¥æ·»åŠ ç»„ä»¶åï¼š
// import { Button } from '@nixora/ui'
```

### 3. æ£€æŸ¥ç±»å‹æç¤º

åœ¨æ¶ˆè´¹è€…é¡¹ç›®ä¸­ï¼ŒIDE åº”è¯¥èƒ½å¤Ÿè‡ªåŠ¨è¡¥å…¨å¹¶æ˜¾ç¤ºç±»å‹æç¤ºã€‚

---

## å›æ»šæ–¹æ¡ˆ

å¦‚æœæ”¹é€ è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜ï¼Œæ¯ä¸€æ­¥éƒ½å¯ä»¥ç‹¬ç«‹å›æ»šï¼š

- **æ­¥éª¤ 1-3**ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ `git checkout` æ¢å¤
- **æ­¥éª¤ 4**ï¼šè°ƒæ•´ä¾èµ–ï¼Œè¿è¡Œ `pnpm install` æ¢å¤
- **æ­¥éª¤ 5**ï¼šåˆ›å»ºæ–‡ä»¶ï¼Œç›´æ¥åˆ é™¤å³å¯
- **æ­¥éª¤ 6**ï¼šåˆ é™¤æ–‡ä»¶ï¼Œä» git æ¢å¤
- **æ­¥éª¤ 7**ï¼šå¯é€‰æ­¥éª¤ï¼Œç›´æ¥åˆ é™¤ `dev` ç›®å½•

---

## æ½œåœ¨é—®é¢˜é¢„è­¦

### âš ï¸ é—®é¢˜ 1ï¼šTailwind CSS é…ç½®
- **ç°è±¡**ï¼šç»„ä»¶åº“æ¶ˆè´¹è€…éœ€è¦é…ç½® Tailwind æ‰èƒ½æ­£å¸¸æ˜¾ç¤ºæ ·å¼
- **è§£å†³**ï¼šè€ƒè™‘ä½¿ç”¨ CSS-in-JS æˆ–å°† Tailwind ç¼–è¯‘ä¸ºé™æ€ CSS

### âš ï¸ é—®é¢˜ 2ï¼šæ ·å¼éš”ç¦»
- **ç°è±¡**ï¼šç»„ä»¶æ ·å¼å¯èƒ½ä¸æ¶ˆè´¹è€…é¡¹ç›®å†²çª
- **è§£å†³**ï¼šä½¿ç”¨ CSS Modules æˆ–æ·»åŠ å‘½åç©ºé—´å‰ç¼€

### âš ï¸ é—®é¢˜ 3ï¼šReact ç‰ˆæœ¬å…¼å®¹æ€§
- **ç°è±¡**ï¼špeerDependencies è®¾ç½®è¿‡ä¸¥å¯èƒ½å¯¼è‡´å®‰è£…å¤±è´¥
- **è§£å†³**ï¼šä½¿ç”¨å®½æ¾çš„ç‰ˆæœ¬èŒƒå›´ `^18.0.0 || ^19.0.0`

### âš ï¸ é—®é¢˜ 4ï¼šTree Shaking
- **ç°è±¡**ï¼šæ¶ˆè´¹è€…æ‰“åŒ…æ—¶æ— æ³•æ­£ç¡® tree-shake
- **è§£å†³**ï¼šç¡®ä¿ `package.json` çš„ `sideEffects` å­—æ®µæ­£ç¡®é…ç½®

---

## æ‰§è¡Œå»ºè®®

1. **æŒ‰é¡ºåºæ‰§è¡Œ**ï¼šæ­¥éª¤ 1-6 æœ‰ä¾èµ–å…³ç³»ï¼Œå»ºè®®é¡ºåºæ‰§è¡Œ
2. **æ¯æ­¥éªŒè¯**ï¼šæ¯å®Œæˆä¸€æ­¥ï¼Œè¿è¡Œæ„å»ºç¡®ä¿æ— é”™è¯¯
3. **æäº¤é¢‘ç‡**ï¼šæ¯å®Œæˆä¸€æ­¥å°±æäº¤ä¸€æ¬¡ï¼Œæ–¹ä¾¿å›æ»š
4. **æš‚ç¼“æ­¥éª¤ 7**ï¼šç­‰å‰ 6 æ­¥ç¨³å®šåå†è€ƒè™‘æ·»åŠ å¼€å‘ç¯å¢ƒ

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

**ç­‰å¾…ä½ çš„å®¡æ ¸åé¦ˆ**ï¼Œç¡®è®¤æ— è¯¯åæˆ‘å°†å¼€å§‹æ‰§è¡Œæ”¹é€ ã€‚

å¦‚æœä½ æœ‰ä»»ä½•ç–‘é—®æˆ–éœ€è¦è°ƒæ•´è®¡åˆ’ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼š
- æ˜¯å¦åŒæ„è¿™ä¸ªæ”¹é€ æ–¹æ¡ˆï¼Ÿ
- æ˜¯å¦éœ€è¦è°ƒæ•´æŸäº›æ­¥éª¤çš„ä¼˜å…ˆçº§ï¼Ÿ
- æ˜¯å¦æœ‰å…¶ä»–ç‰¹æ®Šéœ€æ±‚ï¼Ÿ
